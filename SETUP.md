# Setup Guide: Integrating RAG Chain with Frontend

This guide will help you set up and run the integrated RAG chain backend with your frontend.

## Prerequisites

1. Python 3.8+ installed
2. Node.js and npm installed (for frontend)
3. Ollama installed and running with the `mistral` model
4. FAISS index files in the `indexes/` folder (`video_index.index` and `video_index.meta.pkl`)

## Backend Setup

1. **Install Python dependencies:**
   ```bash
   pip install -r requirements.txt
   ```

2. **Make sure Ollama is running:**
   ```bash
   # Check if Ollama is running
   ollama list
   
   # If mistral model is not installed:
   ollama pull mistral
   ```

3. **Verify your index files exist:**
   - Check that `indexes/video_index.index` exists
   - Check that `indexes/video_index.meta.pkl` exists

4. **Start the FastAPI backend:**
   ```bash
   python main.py
   ```
   
   The server will start at `http://localhost:8000`
   
   You can test it by visiting:
   - `http://localhost:8000/` - Health check
   - `http://localhost:8000/docs` - Interactive API documentation

## Frontend Setup

1. **Navigate to the frontend directory:**
   ```bash
   cd video-q-a-studio
   ```

2. **Install dependencies (if not already done):**
   ```bash
   npm install
   ```

3. **Set the API URL (optional):**
   Create a `.env` file in `video-q-a-studio/` directory:
   ```
   VITE_API_URL=http://localhost:8000
   ```
   
   If you don't create this file, it will default to `http://localhost:8000`

4. **Start the frontend:**
   ```bash
   npm run dev
   ```
   
   The frontend will start at `http://localhost:8080` (or the port shown in terminal)

## Testing the Integration

1. Make sure both backend and frontend are running
2. Open your browser to the frontend URL (usually `http://localhost:8080`)
3. Enter a question about the video in the input field
4. The answer should appear, generated by your RAG chain using Ollama

## API Endpoints

- `GET /` - Health check
- `GET /health` - Detailed health check
- `POST /ask-question` - Ask a question about the video
  - Request body: `{ "question": "Your question here" }`
  - Response: `{ "answer": "Generated answer" }`
- `POST /process-video` - Process a YouTube video (extract transcript, index, update RAG pipeline)
  - Request body: `{ "video_url": "https://www.youtube.com/watch?v=..." }`
  - Response: `{ "success": true, "message": "...", "video_id": "..." }`
- `GET /suggested-videos` - Get suggested/recommended videos
  - Query params: `?video_id=VIDEO_ID` (optional - if provided, returns videos related to that video)
  - Response: `{ "videos": [{ "id": "...", "title": "...", "thumbnail": "...", "url": "..." }] }`

## Troubleshooting

### Backend Issues

- **"RAG chain not initialized"**: Check that your index files exist in `indexes/` folder
- **"Ollama connection error"**: Make sure Ollama is running and the `mistral` model is installed
- **CORS errors**: Check that the frontend URL is in the `allow_origins` list in `main.py`

### Frontend Issues

- **"Failed to fetch"**: Make sure the backend is running on port 8000
- **"Network error"**: Check that `VITE_API_URL` in `.env` matches your backend URL

## Suggested Videos Feature

The app includes a suggested videos section that shows relevant content. There are two ways to use this:

### Option 1: Using YouTube Data API (Recommended)

For dynamic, relevant video suggestions based on the current video:

1. **Get a YouTube Data API Key:**
   - Go to [Google Cloud Console](https://console.cloud.google.com/)
   - Create a new project or select an existing one
   - Enable the YouTube Data API v3
   - Create credentials (API Key)
   - Copy your API key

2. **Set the API Key:**
   ```bash
   # On Windows (PowerShell)
   $env:YOUTUBE_API_KEY="your-api-key-here"
   
   # On Linux/Mac
   export YOUTUBE_API_KEY="your-api-key-here"
   ```

3. **Restart the backend server** - it will automatically use the API key to fetch related videos

### Option 2: Default Suggestions (No API Key Required)

If you don't set a YouTube API key, the app will show a curated list of default suggested videos. You can customize these in `main.py` in the `/suggested-videos` endpoint.

## Next Steps

- You can customize the model name in `main.py` (change `model_name="mistral"` to your preferred model)
- Adjust `top_k` parameter in the `ask_question` endpoint to retrieve more/fewer chunks
- Modify the CORS settings if you deploy to a different domain
- Customize the default suggested videos list in the `/suggested-videos` endpoint

